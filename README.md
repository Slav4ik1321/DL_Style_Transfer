# Neural Style Transfer: CIFAR-10 & QuickDraw

![Python](https://img.shields.io/badge/Python-3.8%2B-blue)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0%2B-ee4c2c)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å—Ç–∏–ª—è (Neural Style Transfer) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–≤–µ—Ä—Ç–æ—á–Ω–æ–π –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ **VGG19**.

–í –∫–∞—á–µ—Å—Ç–≤–µ **–∫–æ–Ω—Ç–µ–Ω—Ç–∞** –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ **CIFAR-10**, –≤ –∫–∞—á–µ—Å—Ç–≤–µ **—Å—Ç–∏–ª—è** ‚Äî –Ω–∞–±—Ä–æ—Å–∫–∏ –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ **Google QuickDraw**.

## üìã –ó–∞–¥–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö —É—á–µ–±–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –ø–æ –≥–ª—É–±–æ–∫–æ–º—É –æ–±—É—á–µ–Ω–∏—é. –û—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1.  **–ú–æ–¥–µ–ª—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—É—é CNN (VGG19) –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
2.  **–î–∞–Ω–Ω—ã–µ:**
    *   –ö–æ–Ω—Ç–µ–Ω—Ç: CIFAR-10.
    *   –°—Ç–∏–ª—å: QuickDraw (–∫–∞—Ç–µ–≥–æ—Ä–∏—è `cat`).
3.  **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –¥–≤—É—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
    *   (I) Content Loss: MSE –º–µ–∂–¥—É –∫–∞—Ä—Ç–∞–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
    *   (II) Style Loss: MSE –º–µ–∂–¥—É –º–∞—Ç—Ä–∏—Ü–∞–º–∏ –ì—Ä–∞–º–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
4.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (LBFGS).
5.  **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –Ω–∞ 50+ –ø—Ä–∏–º–µ—Ä–∞—Ö —Å –∞–Ω–∞–ª–∏–∑–æ–º –º–µ—Ç—Ä–∏–∫.

## üöÄ –ó–∞–ø—É—Å–∫

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –¥–≤–∞ —Å–∫—Ä–∏–ø—Ç–∞:

### 1. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–°–∫—Ä–∏–ø—Ç `research_script.py` –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ª–æ–∏ VGG –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ —Å—Ç–∏–ª—è, –≤—ã—á–∏—Å–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (Hard/Soft Stability) –∏ –≤—ã–≤–æ–¥–∏—Ç —Ç–∞–±–ª–∏—Ü—É —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (`Score`). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

```bash
python experiments_v2.py
```

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
–°–∫—Ä–∏–ø—Ç `final_generation.py` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **50 —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ–∏–∫–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–µ –∫–æ–ª–ª–∞–∂–∏.

```bash
python 50_examples.py
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ –ø–∞–ø–∫—É `./data`.

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `50_examples.py` –≤ –ø–∞–ø–∫–µ `final_report_plots` –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∏—Ç–æ–≥–æ–≤—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:

### 1. –°–µ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (`images_grid.jpg`)
–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ç—Ä–æ–π–∫–∏: **–ò—Å—Ö–æ–¥–Ω–æ–µ —Ñ–æ—Ç–æ (CIFAR) ‚Üí –°—Ç–∏–ª—å (QuickDraw) ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç**.

–ö–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä —Å–Ω–∞–±–∂–µ–Ω –∞–Ω–Ω–æ—Ç–∞—Ü–∏–µ–π:
*   **True:** –ò—Å—Ç–∏–Ω–Ω—ã–π –∫–ª–∞—Å—Å –æ–±—ä–µ–∫—Ç–∞.
*   **VGG:** –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ *–¥–æ* –∏ *–ø–æ—Å–ª–µ* —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏.
    *   üü¢ **–ó–µ–ª–µ–Ω—ã–π —Ç–µ–∫—Å—Ç:** –ö–ª–∞—Å—Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤–µ—Ä–Ω–æ (—Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞ —Å–µ–º–∞–Ω—Ç–∏–∫—É).
    *   üî¥ **–ö—Ä–∞—Å–Ω—ã–π —Ç–µ–∫—Å—Ç:** –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—à–∏–±—Å—è (—Å—Ç–∏–ª—å –∏—Å–∫–∞–∑–∏–ª –æ–±—ä–µ–∫—Ç).

### 2. –ì—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è (`losses_grid.jpg`)
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å (Loss History) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ 50 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
*   **–ö—Ä–∞—Å–Ω—ã–π:** Style Loss (–Ω–∞–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç—É—Ä—ã).
*   **–°–∏–Ω–∏–π:** Content Loss (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã).

## üß† –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **VGG19** (–≤–µ—Å–∞ ImageNet).
*   **Content Layer:** `conv_10` (—Å–ª–æ–π –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—â–µ–π —Ñ–æ—Ä–º—ã).
*   **Style Layers:** `conv_1` ... `conv_5` (–Ω–∞—á–∞–ª—å–Ω—ã–µ —Å–ª–æ–∏ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ç–µ–∫—Å—Ç—É—Ä—ã —à—Ç—Ä–∏—Ö–æ–≤).

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å—Ç–∏–ª—è –±—ã–ª–∞ –≤–≤–µ–¥–µ–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ **Stability Score**:
1.  **Hard Stability:** –°–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ –∫–ª–∞—Å—Å (`argmax`) –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è VGG –¥–ª—è –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏ —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
2.  **Soft Stability:** KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è –º–µ–∂–¥—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∫–ª–∞—Å—Å–æ–≤.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ 50_examples.py    # –°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 50 –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚îú‚îÄ‚îÄ experiments_v2.py     # –°–∫—Ä–∏–ø—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —Å–ª–æ–µ–≤
‚îú‚îÄ‚îÄ data/                  # –ü–∞–ø–∫–∞ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ final_report_plots/    # –ü–∞–ø–∫–∞ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ä–∞–±–æ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ images_grid.jpg
‚îÇ   ‚îî‚îÄ‚îÄ losses_grid.jpg
‚îî‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```
